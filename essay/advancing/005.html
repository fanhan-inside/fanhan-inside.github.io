<!doctype html>
<html>

<head>
    <meta lang="zh" charset="UTF-8">
    <title>三自贴图运动</title>
    <link rel="stylesheet" type="text/css" href="advancing.css" />
</head>

<body>
    <header>
        <h1>三自贴图运动</h1>
    </header>

    <main>
        <section>
            <h2><span>释题</span></h2>
            <p>一言以蔽之：「自力更生艰苦奋斗，自己动手丰衣足食，自由民主进步和谐」者也。</p>
        </section>
        <section>
            <h2><span>缘起</span></h2>
            <p>就在5月27日下午睡醒起来，登录知乎发现多了26条站内短信，站方将一篇提问及回答（№060）「<mark>亦当删去</mark>」，并将二十五篇《<cite>〈设定集〉注释</cite>》《<cite>〈恶补记〉流水帐</cite>》「<mark>政治敏感</mark>」。于是，对照着动态更新《<cite>谈笑风生＠知乎</cite>》的「目录」和「索引」，同时开始编纂「导读」。</p>
            <p>就在编纂过程中，5月28日凌晨一点零七分，钦定死机再现，当头一张蓝屏「内存错误」。见怪不怪了，之前几天都这样，重启之后会进入「启动修复」，之前的成果都回滚。这次参考根据政治和意识形态斗争新动向，决定不再继续陪着这帮逗哔打哑谜了。</p>
            <p>所以，把2011年攒好但一直没用的台式机重装系统，「<abbr class="software">Microsoft©™® Windows©™® 7 简体中文旗舰版</abbr>」。与此同时，在现有台式机上开始往盘阵上备份。备份过程中键盘鼠标无响应，重启，再也起不来了也。于是直接用新机，只安装必要的软件，然后在线更新，差不多一整天都这么过去了。</p>
            <p>这台攒机之初本来想当家用服务器的，于是选了小主板，当时的APU（集成显卡），且只有8GB内存。性能虽然不如原来AMD六核、独立显卡、16GB内存的旧机，但是上面也没装那么多千奇百怪的软件，也不准备再装，当前用起来还是比较顺畅的。</p>
            <p>5月29日凌晨四点，继续之前的计划，把在知乎与简书都不可见的文章于「作业部落」上传，完成了《<cite>〈谈笑风生＠知乎〉导读</cite>》，并在简书发表。</p>
            <p>然后「惊喜」的发现，换了新机之后GitHub能连上了，于是下了几个Typora主题。而其它若干网站还是不行，可见伟光正官方于「防火长城」中对「<mark>政治敏感</mark>」的定义，与钦定黑客远程入侵人民群众家用计算机种下木马进行实时拦截的规则，还是有些微妙的差别。这个差别正好可以在「导读」中对比知乎和简书的「执法力度」的列表中体现出来。</p>
            <p>顺便，选择Markdown格式码字的理由之一，就是能插入表格，于是罗列数据轻松许多，也用不着本地编纂之后截图上传，这是在线富文本编辑器做不到的，知乎和简书都一样。</p>
            <p>对我来说，富文本编辑器唯一的使用场合，就是需要插入视频的时候。迄今为止在简书上传的三百七十一篇文章中，只有《<cite>〈设定集〉注释》（廿六）（三十）（卅六）（卅七）（卌九）</cite>这五篇使用富文本编辑器，其它篇目都用Markdown编辑器。</p>
            <p>不过呢，虽然Markdown扩展极大充沛，本地码字轻松惬意，但是也得需要站方支持才行。比方说数学公式、流程图等高级功能，简书就不支持，于是只能用图片，顺便提供「作业部落」链接以示「真实效果」。</p>
            <p>并且，之前也提到了，自动生成的公式和流程图，以及一些网络来源的图片，由于透明背景的缘故，在暗色主题之下前景文字看不清。本地编辑有这个问题，而简书「夜间模式」情况下也有这个问题。</p>
            <p>在3月27日上传的《<a target="_blank" href="https://www.jianshu.com/p/75ee478e8eed">流程图测试：某「企业文化」卓越的公司「抓壮丁」示意图</a>》结尾提到了：</p>
            <blockquote>
                <p>请注意一个细节，目前Typora在暗色主题之下，流程图的线条仍然是黑色的，于是看不清楚，这个问题在VS Code当中就没有，或许是使用的插件或实现不一样，希望Typora团队能及时改进。</p>
            </blockquote>
            <p>当时的Typora版本号忘了，但是更新了几版之后，再打开旧文，发现这个问题目前已经解决。</p>
            <p>而使用图片上传之后出现问题，当然不是站方原因，还是写手所用「素材」不合格的缘故。因此，对应「新机气象」，咱作为「精神病仆街写手不入流码农数学渣」决定掀起一场如火如荼的「三自贴图运动」：只使用<abbr class="software">Typora</abbr>和<abbr
                    class="software">Visual Studio Code</abbr>这两个可供人民群众免费获得的「编辑器」完成修正「素材」之工作。</p>
            <p>注意，修正素材的工作本身，不需要截图软件；但是为了展现过程，还是需要对本地编辑器进行实时截图，最终体现在本文的「过程」一节当中。</p>
            <p>昨天（5月30日）一整天都在干这事，由于老迈年高（已经超过34岁好多年了）且脱离业界许久，各种伎俩已经相当生疏，不得不在回忆和上网乱搜弥补代沟的协助之下，一路连滚带爬才勉强实现了目标。</p>
        </section>
        <section>
            <h2><span>目标</span></h2>

            <h3><span>数学公式</span></h3>

            <p>之前提到了，在线的解决方案，通常是「MathJax」，也是Typora使用的方式，所以支持一些Unicode字符。而VS Code的插件「Markdown + Math」使用的是「KaTeX」，因此同样的LaTeX内容在「知乎」和「作业部落」显示正常，在本地Typora也显示正常，唯独VS
                Code当中不正常。
            </p>
            <p>对应的例子，选择了在知乎的这个提问：《<a target="_blank" href="https://www.zhihu.com/question/265090828">线性代数的「克罗内克记号」、实分析的「选民范数」，与计算机科学的「你死我活逻辑」之间有什么联系？</a>》。</p>
            <p>而在简书的备份《<a target="_blank" href="https://www.jianshu.com/p/fccf7e442931">【提问＆回复＠知乎】（№051）</a>》当中，使用贴图实现，于是「夜间模式」下字迹不清晰。</p>
            <p>其中的「非我族类其心必异范数」的公式，出现了「<span class="holy">✡☪✠☭</span>」这四个闪米特独神论邪教四大变种的代表符号，于VS Code中无法渲染，所以正好拿来当作修正对象。</p>

            <h3><span>流程图（Mermaid/Graph、FlowChart）</span></h3>

            <p>之前发表过两篇关于Markdown扩展格式的随笔，「抓壮丁示意图」使用了「Mermaid」扩展的「Graph」功能，而「网文打斗套路」则使用了「FlowChart」，所以各自选一个例子。</p>
            <p>注意，在VS Code当中使用「Markdown Preview Mermaid Support」插件可以预览前者，但是后者还没有找到对应插件。</p>

            <h3><span>其它</span></h3>

            <p>如甘特图、序列图等功能，目前还没用到。先念两句诗「纸上得来终觉浅，绝知此事要躬行」，等什么时候码字需要亲自体会到了，再来继续谈笑风生不迟。</p>
            <p>不过呢，步骤大同小异，不入流码农稍微集中精神即可举一反三。没准在那可以展望的将来，老迈年高的我「日理万机无暇周览」，把这事忘了也说不定。</p>
        </section>
        <section>
            <h2><span>过程</span></h2>

            <h3><span>环境</span></h3>

            <h4><span>Typora</span></h4>

            <p>下载或更新至最新版本，本地使用「0.9.52 (beta)」版。</p>

            <h4><span>Visual Studio Code</span></h4>

            <p>也要下载或更新至最新版本，本地使用「1.23.1」版码字，并集成了Git本地存储管理。</p>
            <figure>
                <img src="image/005-001.png" alt="使用VSCode集成Git管理MyWorks文件夹" />
                <figcaption><span class="figcaption">使用VSCode集成Git管理MyWorks文件夹</span></figcaption>
            </figure>
            <p>但是，对照Typora的「beta」，VSCode的「最新版」是「1.24.0-Insiders」，一个前瞻性质的每夜构建的版本，有公开下载链接，可以与稳定版同时安装且共存。</p>
            <p>所以，在用稳定版码字的同时，用前瞻版完成「修正素材」工作。</p>

            <h4><span>插件</span></h4>
            <p>在Typora这边不需要，而VSCode则需要「SVG Viewer」，其它（码字或便于使用或美化界面相关）插件暂略。</p>

            <h3><span>准备工作</span></h3>

            <h4><span>启动Typora，输入公式和流程图，确保显示正常</span></h4>

            <figure>
                <img src="image/005-002.png" alt="用Typora输入内容" />
                <figcaption><span class="figcaption">用Typora输入内容</span></figcaption>
            </figure>

            <p>这是Typora的源代码模式（通过「<code>Ctrl+/</code>」切换）：</p>

            <figure>
                <img src="image/005-003.png" alt="Typora源代码模式" />
                <figcaption><span class="figcaption">Typora源代码模式</span></figcaption>
            </figure>

            <h4><span>使用菜单命令「文件」→「导出」→「HTML (without styles)」</span></h4>

            <figure>
                <img src="image/005-004.png" alt="Typora导出Html（无样式）" />
                <figcaption><span class="figcaption">Typora导出Html（无样式）</span></figcaption>
            </figure>

            <p>这时预览效果是这样的：</p>
            <figure>
                <img src="image/005-005.png" alt="网页（无样式）效果" />
                <figcaption><span class="figcaption">网页（无样式）效果</span></figcaption>
            </figure>

            <p>只有「数学公式」显示正常，那是因为「流程图」功能其实是借用了「代码块」扩展的语法（参考上面「源代码模式」），在（Typora当前版本）无样式的情况下不会被处理。</p>

            <h4><span>那么导出完整版HTML即可</span></h4>

            <figure>
                <img src="image/005-006.png" alt="Typora导出Html" />
                <figcaption><span class="figcaption">Typora导出Html</span></figcaption>
            </figure>

            <p>预览效果是这样的：</p>
            <figure>
                <img src="image/005-007.png" alt="网页效果" />
                <figcaption><span class="figcaption">网页效果</span></figcaption>
            </figure>

            <h4><span>关闭Typora</span></h4>

            <p>接下来的工作都是VS Code的了。</p>

            <h3><span>「非我族类其心必异范数」</span></h3>

            <h4><span>使用VSCode打开无样式网页文件</span></h4>

            <figure>
                <img src="image/005-008.png" alt="VSCode打开无样式网页文件" />
                <figcaption><span class="figcaption">VSCode打开无样式网页文件</span></figcaption>
            </figure>

            <p>用右键菜单命令或按「<code>Alt+Shift+F</code>」格式化代码：</p>

            <figure>
                <img src="image/005-009.png" alt="VSCode格式化代码" />
                <figcaption><span class="figcaption">VSCode格式化代码</span></figcaption>
            </figure>

            <p>找到「<code>&lt;svg</code>」（图中选中状态）以及「<code>&lt;/svg&gt;</code>」标签。</p>

            <h4><span>将SVG内容提出另存</span></h4>

            <p>将「<code>&lt;svg</code>」与「<code>&lt;/svg&gt;</code>」之间的内容复制，新建文件，粘贴过去，按「<code>Ctrl+K M</code>」键选择SVG语言模式：</p>

            <figure>
                <img src="image/005-010.png" alt="新建SVG文件" />
                <figcaption><span class="figcaption">新建SVG文件</span></figcaption>
            </figure>

            <p>格式化代码之后保存SVG文件：</p>

            <figure>
                <img src="image/005-011.png" alt="保存SVG文件" />
                <figcaption><span class="figcaption">保存SVG文件</span></figcaption>
            </figure>

            <h4><span>修改SVG文件使得预览正常</span></h4>

            <p>现在状态的SVG文件不完整，（在Windows下）双击使用IE打开，会只显示「✡☪☭」三个字符（不是四个），而用Chrome或Firefox打开，则提醒缺少样式于是显示作为xml格式的文件内容。这里不贴图。</p>
            <p>首先保证显示正常，只需要在开头的「<code>&lt;svg</code>」后面加上一条属性「<code>xmlns=&quot;http://www.w3.org/2000/svg&quot;</code>」即可，然后按「<code>Alt+Shift+S O</code>」在侧边栏打开预览：</p>

            <figure>
                <img src="image/005-012.png" alt="预览SVG文件" />
                <figcaption><span class="figcaption">预览SVG文件</span></figcaption>
            </figure>

            <p>稍有经验的用户都能注意到这种显示效果意味着「背景色」是透明的，这就是暗色背景下字迹模糊不清的原因。</p>
            <p>为什么在Typora乃至附加了样式的网页当中随主题切换颜色，那是因为SVG中频繁出现「<code>currentColor</code>」属性值，表示使用环境当前设置中的颜色。</p>
            <p>注意，这种方式只能用于「内置」（inline/embedded）的SVG，而「外链」（在「<code>img</code>」标签当中引用）的SVG文件就不行。</p>

            <h4><span>修改SVG文件确保预览效果</span></h4>

            <p>因此，为了「贴图」，最起码需要修改背景色，至于颜色固定不变导致在部分主题配色之下与环境不和谐，那就顾不上了也。</p>
            <p>这个也简单，还是在「<code>&lt;svg</code>」标签之内，找到「<code>style</code>」属性，增加一条「<code>background-color: white;</code>」即可：</p>

            <figure>
                <img src="image/005-013.png" alt="修改SVG背景色" />
                <figcaption><span class="figcaption">修改SVG背景色</span></figcaption>
            </figure>

            <p>然后呢，又发现这个图片尺寸太小了……本来SVG就是可缩放的矢量图形，按理说可以放大才对吖。</p>
            <p>这个就不用提醒了，哪怕外行，举一反三就肯定能在「<code>svg</code>」标签内部找到「<code>width=&quot;51.441ex&quot; height=&quot;6.032ex&quot;</code>」这段。若是不理解尺寸单位「<code>ex</code>」，那么保险起见，按照比例放大一倍总没问题吧？</p>

            <figure>
                <img src="image/005-014.png" alt="放大SVG尺寸" />
                <figcaption><span class="figcaption">放大SVG尺寸</span></figcaption>
            </figure>

            <p>接下来，发现<strong>简书不支持上传SVG格式图片</strong>，于是可以使用快捷键「<code>Alt+Shift+S V</code>」打开导出PNG面板：</p>

            <figure>
                <img src="image/005-015.png" alt="导出PNG格式" />
                <figcaption><span class="figcaption">导出PNG格式</span></figcaption>
            </figure>

            <p>点击「<code>Export PNG</code>」按钮，文件保存成功，就在SVG文件同一个目录之下。</p>

            <figure>
                <img src="image/005-016.png" alt="保存PNG文件成功" />
                <figcaption><span class="figcaption">保存PNG文件成功</span></figcaption>
            </figure>

            <h4><span>无样式网页文件用途结束</span></h4>

            <p>这个不用提醒，接下来两幅流程图都保存在带样式网页文件中，仿本例，在VS Code中打开HTML文件并格式化代码。截图略。</p>

            <h3><span>「抓壮丁示意图」</span></h3>

            <h4><span>找到SVG内容</span></h4>

            <p>搜索文本并找到对应的「<code>&lt;svg</code>」标签（以及「<code>&lt;/svg&gt;</code>」标签）：</p>

            <figure>
                <img src="image/005-017.png" alt="找到SVG内容" />
                <figcaption><span class="figcaption">找到SVG内容</span></figcaption>
            </figure>

            <h4><span>保存SVG文件并预览</span></h4>

            <p>步骤同上，新建文件，粘贴SVG内容，选择SVG语言模式，格式化代码，保存，打开侧边栏预览：</p>

            <figure>
                <img src="image/005-018.png" alt="预览SVG文件" />
                <figcaption><span class="figcaption">预览SVG文件</span></figcaption>
            </figure>

            <p>唔……这个文件看上去问题比较多。</p>

            <h4><span>修改SVG文件</span></h4>

            <p>这次改法就不一样了，在「<code>&lt;style&gt;</code>」块内增加点「样式」即可。</p>
            <p>第一行是整个SVG文件的样式，追加背景色「<code>background-color: dimgray;</code>」填充色「<code>fill: dimgray;</code>」边框色「<code>stroke: red;</code>」这三项。</p>
            <p>第二行是「箭头」标签文字的样式，追加文字色「<code>color: lime;</code>」一项。</p>
            <p>第三行是「节点」的样式，追加文字色「<code>color: yellow;</code>」边框色「<code>stroke: blue;</code>」两项。</p>
            <p>预览效果是这样的：</p>

            <figure>
                <img src="image/005-019.png" alt="修改SVG文件" />
                <figcaption><span class="figcaption">修改SVG文件</span></figcaption>
            </figure>

            <p>图上红黄蓝绿都有了，花里胡哨看着眼晕是吧？</p>
            <p>是吖，作为例子，这样才能区分开不同的属性针对的效果。接下来就是「留做习题答案略，读者自证不难」了，谁有什么装潢的构思，照葫芦画瓢就这么改。</p>

            <h4><span>导出PNG文件</span></h4>
            <p>步骤同上，略。</p>

            <h3><span>「网文打斗套路」开头</span></h3>

            <h4><span>获取SVG内容保存为文件并预览</span></h4>
            <p>步骤同上，略。</p>

            <figure>
                <img src="image/005-020.png" alt="保存SVG文件并预览" />
                <figcaption><span class="figcaption">保存SVG文件并预览</span></figcaption>
            </figure>

            <h4><span>修改SVG文件并确认效果</span></h4>
            <p>在「<code>&lt;svg&gt;</code>」标签内部「<code>style</code>」属性中增加「<code>background-color: white; fill: white;</code>」两条：</p>

            <figure>
                <img src="image/005-021.png" alt="修改SVG文件并确认效果" />
                <figcaption><span class="figcaption">修改SVG文件并确认效果</span></figcaption>
            </figure>

            <h4><span>导出PNG文件（略）</span></h4>

            <h3><span>搞定</span></h3>

            <p>所以，应景修改「提问＆回答＠知乎」（№051），使用修正过的素材，效果如下：</p>

            <figure>
                <img src="image/005-022.png" alt="搞定之效果" />
                <figcaption><span class="figcaption">搞定之效果</span></figcaption>
            </figure>

            <p>在简书的「夜间模式」状态下，公式文字仍很清晰，虽然不那么和谐。</p>
        </section>
        <section>
            <h2><span>后记</span></h2>

            <p>篇幅够长了，长话短说吧。</p>
            <p>先说Typora。作为「所见即所得」的编辑器，还提供了「源代码模式」，其实很优秀了，尤其是对于「看纯文本眼晕」的用户来说，完全可以不关心Markdown格式的细节，专心码字。</p>
            <p>但是呢，有过「不入流码农」职业经历的我，关注的还是各种Markdown扩展功能，这种时候就需要稍微注重「代码」的编辑器了。更何况，绘图功能也是利用「代码块」实现的。</p>
            <p>相信看过前两篇Markdown相关随笔的码字工作者，对于利用流程图构思大纲也会感兴趣，即便在Typora内部也会试着写点「简单的脚本」吧。</p>
            <p>顺便，Typora当前对「公式块」的处理，要求作为标识符的「<code>$$</code>」与LaTeX公式不能位于同一行上，否则不能识别为公式并提供预览。在修改的过程中，就需要切换到「源代码模式」手动换行，再切换回来，就能看到实时公式预览了。</p>
            <p>再说SVG。虽然看着眼晕，据传某大佬的「XML语法对人类和机器都不友好，W3C『大力』推广许久都难以普及」这种说法在某种程度上是对的，但是因为HTML就是这种格式，所以互联网应用还就得在「内容」领域高举「XML」伟大旗帜为了「标签大融合」的光荣目标而正确奋斗。</p>
            <p>再顺便，看SVG的内容，也就是设定点颜色了字体了到处划线涂块，「其实没啥」是吧？哎，我等老迈年高码农当年在Windows/Linux上用C语言写GDI/GTK+调用的时候就是这种感觉，哪怕是与时俱进的童年才俊，用dotNet了Java了，照样也得这么写。</p>
            <p>这就是基本功，具体某个函数名称叫什么有多少个参数，那都可以实时检索，没必要死记硬背。当年「抱着一本谭浩强每天『<code>i++</code>，<code>++i</code>，<code>i+++++i</code>』的做填空题」的那一批按华为标准要算做「历史唯物主义の尘埃」的「社会渣滓」的超龄码农，练出来的本事还有用。</p>
            <p>而满嘴「你听都没听过的新鲜名词」的与时俱进的童年才俊，过时的速度要比我等老家伙快得多。若要引经据典解释，那就是包括但不限于Java的「垃圾分类收集机制」的算法：越年轻的对象，其生命周期就越短。不服来辩！</p>
        </section>
    </main>
    <footer>
        <p>发表于<time>2018-05-31</time></p>
        <p>范狂夫</p>
        <p>囧斋</p>
    </footer>
</body>

</html>